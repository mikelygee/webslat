{% extends "base_site.html" %}
{% load mathfilters %}
{% load i18n static %}
{% block extrastyle %}{{ block.super }}
    <link rel="stylesheet" type="text/css" href="{% static 'slat/style.css' %}?{ now "U" %}" />
    <script src="{% static "js/jquery-3.2.1.min.js" %}"></script>
    <script src="{% static "js/slat-utils.js" %}"></script>

    {{ form.media }}
{% endblock %}

{% block bodyclass %}{{ block.super }} slat {% endblock %}
{% block title %}WebSLAT: {{ project.title_text }} Detailed Analysis{% endblock %}
{% block content_title %}{{ project.title_text }} Detailed Analysis{% endblock %}
{% block content %}
<div class="project_title">
<b>Project Analysis:</b> {{ project.title_text }}
</div>

<p><b>Annual Cost Mean:</b> {{ project.model.AnnualCost.mean|floatformat:2 }}</p>
<p><b>Annual Cost SD log:</b> {{ project.model.AnnualCost.sd_ln|floatformat:2 }}</p>

{% for level in data %}
    <p><b><a href={% url 'slat:level_cgroups' project.id level.level.id %}>{{ level.level }}</a></b>
      contributites ${{level.total_costs.X|add:level.total_costs.Y|add:level.total_costs.U|floatformat:2}} ({{level.total_costs.X|add:level.total_costs.Y|add:level.total_costs.U|div:project.model.AnnualCost.mean|mul:100|floatformat:1}}%) to the total annual expected cost.
      </p>
    <table border="1">
      <tr>
        <th colspan="2" align="center"style="background:lightgray">Component</th>
        <th style="background:darkgray"></th>
        <th colspan="3" align="center" style="background:lightgray">Quantity</th>
        <th colspan="4" align="center" style="background:darkgray">Cost</th>
      </tr>
      <tr>
        <th style="background:lightgray">ID</th>
        <th style="background:lightgray">Name</th>
        <th style="background:darkgray">Adj</th>
        <th style="background:lightgray">X</th>
        <th style="background:lightgray">Y</th>
        <th style="background:lightgray">U</th>
        <th style="background:darkgray">X</th>
        <th style="background:darkgray">X</th>
        <th style="background:darkgray">U</th>
        <th style="background:darkgray">Total</th>
      </tr>
      {% for c in level.components %}
      <tr><td align='right' style="background:lightgray">{{ c.component.ident }}</td>
        <td style="background:lightgray">{{ c.component.name }}
          {% if c.comment %}
          <br/>
          <table border="0" style="background:lightgray"><tr><td><b>Comment:</b></td><td><i>{{c.comment}}</i></td></tr></table>
          {% endif %}
        </td>
           <td style="background:darkgray">{{ c.cost_adj }}</td>
           <td align="right" style="background:lightgray">{{ c.quantity_x }} </td>
           <td align="right" style="background:lightgray">{{ c.quantity_y }}</td>
           <td align="right" style="background:lightgray">{{ c.quantity_u }}</td>
           <td align="right" style="background:darkgray">{{ c.model.Models.X.E_annual_cost|floatformat:2 }} </td>
           <td align="right" style="background:darkgray">{{ c.model.Models.Y.E_annual_cost|floatformat:2 }} </td>
           <td align="right" style="background:darkgray">{{ c.model.Models.U.E_annual_cost|floatformat:2 }} </td>
           <td align="right" style="background:darkgray">{{ c.model.E_annual_cost|floatformat:2 }} </td>
           </tr>
      {% endfor %}
      <tr><td colspan="6" align="right">Total</td>
        <td align="right" style="background:darkgray">{{ level.total_costs.X|floatformat:2 }}</td>
        <td align="right" style="background:darkgray">{{ level.total_costs.Y|floatformat:2 }}</td>
        <td align="right" style="background:darkgray">{{ level.total_costs.U|floatformat:2 }}</td>
        <td align="right" style="background:darkgray">{{ level.total_costs.X|add:level.total_costs.Y|add:level.total_costs.U|floatformat:2 }}</td>
        </tr>
    </table>
<hr/>
{% endfor %}
<a href="{% url 'slat:project' project.id %}">Return to Project</a><br /><br/>
<a href="{% url 'slat:index' %}">Return to Project List</a>

{% endblock %}
